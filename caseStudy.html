<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bouncing Ball Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .game-container {
            text-align: center;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 32px;
        }

        .score-board {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            font-size: 18px;
            color: #333;
        }

        .score-item {
            padding: 10px 20px;
            background: #f0f0f0;
            border-radius: 10px;
        }

        .score-value {
            font-weight: bold;
            color: #667eea;
            font-size: 24px;
        }

        #gameCanvas {
            border: 3px solid #667eea;
            border-radius: 10px;
            background: #f8f9fa;
            display: block;
            margin: 0 auto;
        }

        .controls {
            margin-top: 20px;
            color: #666;
        }

        .btn {
            margin-top: 15px;
            padding: 12px 30px;
            font-size: 16px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn:hover {
            background: #764ba2;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .game-over {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: #ff6b6b;
            color: white;
            border-radius: 10px;
            font-size: 20px;
        }

        .instructions {
            margin-top: 15px;
            padding: 15px;
            background: #e3f2fd;
            border-radius: 10px;
            color: #1976d2;
            font-size: 14px;
        }
    </style>
</head>
<body>
<div class="game-container">
    <h1>üéÆ Bouncing Ball Game</h1>

    <div class="score-board">
        <div class="score-item">
            <div>ƒêi·ªÉm</div>
            <div class="score-value" id="score">0</div>
        </div>
        <div class="score-item">
            <div>Th·ªùi gian</div>
            <div class="score-value" id="time">0s</div>
        </div>
    </div>

    <canvas id="gameCanvas" width="600" height="400"></canvas>

    <div class="game-over" id="gameOver">
        <h2>Game Over!</h2>
        <p>ƒêi·ªÉm c·ªßa b·∫°n: <span id="finalScore"></span></p>
    </div>

    <button class="btn" id="startBtn" onclick="game.start()">B·∫Øt ƒë·∫ßu</button>
    <button class="btn" id="restartBtn" onclick="game.restart()" style="display:none;">Ch∆°i l·∫°i</button>

    <div class="instructions">
        <strong>H∆∞·ªõng d·∫´n:</strong> D√πng ph√≠m ‚Üê ‚Üí ho·∫∑c A D ƒë·ªÉ di chuy·ªÉn thanh ƒë·ª°
    </div>
</div>

<script>
    // ƒê·ªëi t∆∞·ª£ng GameBoard
    class GameBoard {
        constructor(width, height) {
            this.width = width;
            this.height = height;
        }
    }

    // ƒê·ªëi t∆∞·ª£ng Ball
    class Ball {
        constructor(x, y, radius, angle, speed) {
            this.x = x;
            this.y = y;
            this.radius = radius;
            this.angle = angle;
            this.speed = speed;
            this.vx = Math.cos(angle) * speed;
            this.vy = Math.sin(angle) * speed;
        }

        move() {
            this.x += this.vx;
            this.y += this.vy;
        }

        bounceWall(board) {
            // Va ch·∫°m bi√™n tr√°i ho·∫∑c ph·∫£i
            if (this.x - this.radius <= 0 || this.x + this.radius >= board.width) {
                this.vx = -this.vx;
                // ƒêi·ªÅu ch·ªânh v·ªã tr√≠ ƒë·ªÉ tr√°nh b√≥ng b·ªã k·∫πt
                if (this.x - this.radius <= 0) this.x = this.radius;
                if (this.x + this.radius >= board.width) this.x = board.width - this.radius;
            }

            // Va ch·∫°m bi√™n tr√™n
            if (this.y - this.radius <= 0) {
                this.vy = -this.vy;
                this.y = this.radius;
            }
        }

        bounceBar(bar) {
            // Ki·ªÉm tra va ch·∫°m v·ªõi thanh ƒë·ª°
            if (this.y + this.radius >= bar.y &&
                this.y + this.radius <= bar.y + bar.height &&
                this.x >= bar.x &&
                this.x <= bar.x + bar.width) {

                // ƒê·ªïi h∆∞·ªõng b√≥ng
                this.vy = -Math.abs(this.vy);

                // ƒêi·ªÅu ch·ªânh g√≥c d·ª±a tr√™n v·ªã tr√≠ ch·∫°m v√† t·ªëc ƒë·ªô thanh ƒë·ª°
                const hitPos = (this.x - bar.x) / bar.width; // 0 to 1
                const barSpeed = bar.currentSpeed;

                // Thay ƒë·ªïi vx d·ª±a tr√™n v·ªã tr√≠ ch·∫°m v√† t·ªëc ƒë·ªô thanh
                const angleInfluence = (hitPos - 0.5) * 2; // -1 to 1
                const speedInfluence = barSpeed * 0.3;

                this.vx = this.speed * angleInfluence + speedInfluence;

                // ƒê·∫£m b·∫£o t·ªëc ƒë·ªô t·ªïng th·ªÉ kh√¥ng ƒë·ªïi
                const currentSpeed = Math.sqrt(this.vx * this.vx + this.vy * this.vy);
                const scale = this.speed / currentSpeed;
                this.vx *= scale;
                this.vy *= scale;

                this.y = bar.y - this.radius;
                return true;
            }
            return false;
        }

        checkGameOver(board) {
            return this.y - this.radius > board.height;
        }

        draw(ctx) {
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
            ctx.fillStyle = '#667eea';
            ctx.fill();
            ctx.strokeStyle = '#764ba2';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.closePath();
        }
    }

    // ƒê·ªëi t∆∞·ª£ng Bar (thanh ƒë·ª°)
    class Bar {
        constructor(width, height, x, y) {
            this.width = width;
            this.height = height;
            this.x = x;
            this.y = y;
            this.speed = 8;
            this.currentSpeed = 0;
        }

        moveLeft(board) {
            if (this.x > 0) {
                this.x -= this.speed;
                this.currentSpeed = -this.speed;
            }
            if (this.x < 0) this.x = 0;
        }

        moveRight(board) {
            if (this.x + this.width < board.width) {
                this.x += this.speed;
                this.currentSpeed = this.speed;
            }
            if (this.x + this.width > board.width) {
                this.x = board.width - this.width;
            }
        }

        resetSpeed() {
            this.currentSpeed = 0;
        }

        draw(ctx) {
            ctx.fillStyle = '#764ba2';
            ctx.fillRect(this.x, this.y, this.width, this.height);

            // Hi·ªáu ·ª©ng gradient
            const gradient = ctx.createLinearGradient(this.x, this.y, this.x, this.y + this.height);
            gradient.addColorStop(0, '#667eea');
            gradient.addColorStop(1, '#764ba2');
            ctx.fillStyle = gradient;
            ctx.fillRect(this.x, this.y, this.width, this.height);
        }
    }

    // Game Controller
    class Game {
        constructor() {
            this.canvas = document.getElementById('gameCanvas');
            this.ctx = this.canvas.getContext('2d');
            this.board = new GameBoard(this.canvas.width, this.canvas.height);

            this.ball = null;
            this.bar = null;
            this.isRunning = false;
            this.score = 0;
            this.startTime = 0;
            this.animationId = null;
            this.keys = {};

            this.setupControls();
        }

        setupControls() {
            document.addEventListener('keydown', (e) => {
                this.keys[e.key] = true;
            });

            document.addEventListener('keyup', (e) => {
                this.keys[e.key] = false;
                if (this.bar) {
                    this.bar.resetSpeed();
                }
            });
        }

        init() {
            // Kh·ªüi t·∫°o b√≥ng
            this.ball = new Ball(
                this.board.width / 2,
                this.board.height / 2,
                10,
                -Math.PI / 4, // G√≥c -45 ƒë·ªô
                5
            );

            // Kh·ªüi t·∫°o thanh ƒë·ª°
            this.bar = new Bar(
                100,
                15,
                this.board.width / 2 - 50,
                this.board.height - 30
            );

            this.score = 0;
            this.startTime = Date.now();
        }

        start() {
            if (this.isRunning) return;

            this.init();
            this.isRunning = true;

            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('restartBtn').style.display = 'none';
            document.getElementById('gameOver').style.display = 'none';

            this.gameLoop();
        }

        restart() {
            this.start();
        }

        gameLoop() {
            if (!this.isRunning) return;

            this.update();
            this.draw();

            this.animationId = requestAnimationFrame(() => this.gameLoop());
        }

        update() {
            // Di chuy·ªÉn b√≥ng
            this.ball.move();

            // X·ª≠ l√Ω va ch·∫°m v·ªõi t∆∞·ªùng
            this.ball.bounceWall(this.board);

            // X·ª≠ l√Ω va ch·∫°m v·ªõi thanh ƒë·ª°
            if (this.ball.bounceBar(this.bar)) {
                this.score += 10;
            }

            // Ki·ªÉm tra game over
            if (this.ball.checkGameOver(this.board)) {
                this.gameOver();
                return;
            }

            // Di chuy·ªÉn thanh ƒë·ª°
            if (this.keys['ArrowLeft'] || this.keys['a'] || this.keys['A']) {
                this.bar.moveLeft(this.board);
            } else if (this.keys['ArrowRight'] || this.keys['d'] || this.keys['D']) {
                this.bar.moveRight(this.board);
            } else {
                this.bar.resetSpeed();
            }

            // C·∫≠p nh·∫≠t ƒëi·ªÉm s·ªë v√† th·ªùi gian
            const elapsedTime = Math.floor((Date.now() - this.startTime) / 1000);
            this.score = Math.max(this.score, elapsedTime * 5);

            document.getElementById('score').textContent = this.score;
            document.getElementById('time').textContent = elapsedTime + 's';
        }

        draw() {
            // X√≥a canvas
            this.ctx.clearRect(0, 0, this.board.width, this.board.height);

            // V·∫Ω b√≥ng
            this.ball.draw(this.ctx);

            // V·∫Ω thanh ƒë·ª°
            this.bar.draw(this.ctx);
        }

        gameOver() {
            this.isRunning = false;
            cancelAnimationFrame(this.animationId);

            document.getElementById('gameOver').style.display = 'block';
            document.getElementById('finalScore').textContent = this.score;
            document.getElementById('restartBtn').style.display = 'inline-block';
        }
    }

    // Kh·ªüi t·∫°o game
    const game = new Game();
</script>
</body>
</html>